name: $(TeamProject)_$(BuildDefinitionName)_$(SourceBranchName)_$(Date:yyyyMMdd)$(Rev:.r)

pool:
  vmImage: 'Ubuntu-16.04'

steps:

- script: npm install
  displayName: API Install
  workingDirectory: api

- script: npm run-script build
  displayName: API Build
  workingDirectory: api

- task: Npm@1
  inputs:
    displayName: CLI Link to API
    workingDirectory: cli
    command: custom
    customCommand: link '..\api'

- script: npm install
  displayName: CLI Install
  workingDirectory: cli

- script: npm run-script build
  displayName: CLI Build
  workingDirectory: cli
